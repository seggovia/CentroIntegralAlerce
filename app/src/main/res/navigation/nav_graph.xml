<?xml version="1.0" encoding="utf-8"?>
<navigation xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/nav_graph"
    app:startDestination="@id/loginFragment">

    <!-- LOGIN -->
    <fragment
        android:id="@+id/loginFragment"
        android:name="com.centroalerce.auth.LoginFragment"
        android:label="Login">

        <action
            android:id="@+id/action_loginFragment_to_homeFragment"
            app:destination="@id/homeFragment"
            app:popUpTo="@id/loginFragment"
            app:popUpToInclusive="true" />

        <action
            android:id="@+id/action_loginFragment_to_signupFragment"
            app:destination="@id/signupFragment" />

        <action
            android:id="@+id/action_loginFragment_to_contactSupportFragment"
            app:destination="@id/contactSupportFragment" />
    </fragment>

    <!-- SIGNUP -->
    <fragment
        android:id="@+id/signupFragment"
        android:name="com.centroalerce.auth.SignupFragment"
        android:label="Registro">

        <!-- ✅ NUEVO: permitir prellenar el email al abrir Signup -->
        <argument
            android:name="prefillEmail"
            app:argType="string"
            app:nullable="true"
            android:defaultValue="@null" />

        <action
            android:id="@+id/action_signupFragment_to_loginFragment"
            app:destination="@id/loginFragment"
            app:popUpTo="@id/loginFragment"
            app:popUpToInclusive="false" />
    </fragment>

    <!-- CONTACTO/SOPORTE -->
    <fragment
        android:id="@+id/contactSupportFragment"
        android:name="com.centroalerce.auth.ContactSupportFragment"
        android:label="Contactar Soporte">

        <action
            android:id="@+id/action_contactSupportFragment_to_loginFragment"
            app:destination="@id/loginFragment"
            app:popUpTo="@id/loginFragment"
            app:popUpToInclusive="false" />
    </fragment>

    <!-- HOME -->
    <fragment
        android:id="@+id/homeFragment"
        android:name="com.centroalerce.ui.HomeFragment"
        android:label="Inicio">

        <action
            android:id="@+id/action_homeFragment_to_activityFormFragment"
            app:destination="@id/activityFormFragment" />

        <action
            android:id="@+id/action_homeFragment_to_calendarFragment"
            app:destination="@id/calendarFragment" />

        <action
            android:id="@+id/action_homeFragment_to_maintainersFragment"
            app:destination="@id/maintainersFragment" />
    </fragment>

    <!-- CALENDARIO -->
    <fragment
        android:id="@+id/calendarFragment"
        android:name="com.centroalerce.ui.CalendarFragment"
        android:label="Calendario">

        <action
            android:id="@+id/action_calendarFragment_to_detalleActividadFragment"
            app:destination="@id/detalleActividadFragment" />

        <action
            android:id="@+id/action_calendarFragment_to_activityFormFragment"
            app:destination="@id/activityFormFragment" />
    </fragment>

    <!-- LISTA ACTIVIDADES -->
    <fragment
        android:id="@+id/activitiesListFragment"
        android:name="com.centroalerce.ui.ActivitiesListFragment"
        android:label="Actividades">

        <action
            android:id="@+id/action_activitiesListFragment_to_detalleActividadFragment"
            app:destination="@id/detalleActividadFragment" />

        <action
            android:id="@+id/action_activitiesListFragment_to_activityFormFragment"
            app:destination="@id/activityFormFragment" />
    </fragment>

    <!-- CONFIGURACIÓN -->
    <fragment
        android:id="@+id/settingsFragment"
        android:name="com.centroalerce.ui.SettingsFragment"
        android:label="Administración">

        <action
            android:id="@+id/action_settingsFragment_to_maintainersFragment"
            app:destination="@id/maintainersFragment" />

        <!-- Nueva acción para ir al perfil -->
        <action
            android:id="@+id/action_settingsFragment_to_perfilFragment"
            app:destination="@id/perfilFragment" />

        <!-- ✅ Nueva acción: cerrar sesión (lleva al login y limpia el backstack) -->
        <action
            android:id="@+id/action_settingsFragment_to_loginFragment"
            app:destination="@id/loginFragment"
            app:popUpTo="@id/loginFragment"
            app:popUpToInclusive="true" />
    </fragment>

    <!-- DETALLE ACTIVIDAD -->
    <fragment
        android:id="@+id/detalleActividadFragment"
        android:name="com.centroalerce.ui.DetalleActividadFragment"
        android:label="Detalle">

        <argument
            android:name="activityId"
            app:argType="string" />

        <action
            android:id="@+id/action_detalleActividadFragment_to_activityFormFragment"
            app:destination="@id/activityFormFragment" />

        <action
            android:id="@+id/action_detalleActividadFragment_to_activityRescheduleFragment"
            app:destination="@id/activityRescheduleFragment" />
    </fragment>

    <!-- FORMULARIO ACTIVIDAD -->
    <fragment
        android:id="@+id/activityFormFragment"
        android:name="com.centroalerce.ui.ActivityFormFragment"
        android:label="Actividad">

        <argument
            android:name="activityId"
            app:argType="string"
            app:nullable="true"
            android:defaultValue="@null" />
    </fragment>

    <!-- REAGENDAR -->
    <fragment
        android:id="@+id/activityRescheduleFragment"
        android:name="com.centroalerce.ui.ActivityRescheduleFragment"
        android:label="Reagendar">

        <argument
            android:name="activityId"
            app:argType="string" />
    </fragment>

    <!-- MANTENEDORES -->
    <fragment
        android:id="@+id/maintainersFragment"
        android:name="com.centroalerce.ui.MaintainersFragment"
        android:label="Mantenedores">

        <!-- NUEVO: acciones de navegación a cada mantenedor -->
        <action
            android:id="@+id/action_maintainers_to_tiposActividadFragment"
            app:destination="@id/tiposActividadFragment" />
        <action
            android:id="@+id/action_maintainers_to_lugaresFragment"
            app:destination="@id/lugaresFragment" />
        <action
            android:id="@+id/action_maintainers_to_oferentesFragment"
            app:destination="@id/oferentesFragment" />
        <action
            android:id="@+id/action_maintainers_to_sociosFragment"
            app:destination="@id/sociosFragment" />
        <action
            android:id="@+id/action_maintainers_to_proyectosFragment"
            app:destination="@id/proyectosFragment" />
    </fragment>

    <!-- NUEVO: destinos de cada mantenedor -->
    <fragment
        android:id="@+id/tiposActividadFragment"
        android:name="com.centroalerce.ui.mantenedores.TiposActividadFragment"
        android:label="Tipos de actividad" />

    <fragment
        android:id="@+id/lugaresFragment"
        android:name="com.centroalerce.ui.mantenedores.LugaresFragment"
        android:label="Lugares" />

    <fragment
        android:id="@+id/oferentesFragment"
        android:name="com.centroalerce.ui.mantenedores.OferentesFragment"
        android:label="Oferentes de la actividad" />

    <fragment
        android:id="@+id/sociosFragment"
        android:name="com.centroalerce.ui.mantenedores.SociosFragment"
        android:label="Socios comunitarios" />

    <fragment
        android:id="@+id/proyectosFragment"
        android:name="com.centroalerce.ui.mantenedores.ProyectosFragment"
        android:label="Proyectos" />

    <!-- PERFIL -->
    <fragment
        android:id="@+id/perfilFragment"
        android:name="com.centroalerce.ui.PerfilFragment"
        android:label="Mi Perfil" />

</navigation>
